---
phase: 20-intelligence-and-mcp-tools
plan: 02
subsystem: mcp-tools
tags: [mcp, zod, debug-paths, path-management, tool-registration]

# Dependency graph
requires:
  - phase: 20-intelligence-and-mcp-tools
    plan: 01
    provides: "PathTracker.startManually(), resolveManually(), getActivePathId(); PathRepository CRUD"
  - phase: 19-path-detection-and-storage
    provides: "PathRepository, PathTracker, debug_paths/path_waypoints schema"
provides:
  - "Four MCP tools: path_start, path_resolve, path_show, path_list"
  - "registerDebugPathTools() registration function"
  - "KISS summary formatting for path_show display"
affects: [20-03, debug-resolution-ui, mcp-server]

# Tech tracking
tech-stack:
  added: []
  patterns: ["MCP tool registration with Zod schemas following query-graph.ts pattern"]

key-files:
  created: [src/mcp/tools/debug-paths.ts]
  modified: [src/index.ts]

key-decisions:
  - "Response helpers (textResponse, errorResponse, prependNotifications) defined locally rather than shared — trivial 1-liners, avoids coupling"
  - "path_list filters by status in-memory after fetching from DB — simpler than adding SQL variants for each status"
  - "KISS summary JSON parsed defensively with try/catch — graceful degradation if format changes"

patterns-established:
  - "Debug path MCP tools follow same registration pattern as query-graph.ts"
  - "Defensive JSON parsing for stored structured data (KISS summaries)"

# Metrics
duration: 2min
completed: 2026-02-14
---

# Phase 20 Plan 02: Debug Path MCP Tools Summary

**Four MCP tools (path_start, path_resolve, path_show, path_list) for explicit user control over debug path lifecycle with KISS summary display**

## Performance

- **Duration:** 2 min
- **Started:** 2026-02-14T23:12:40Z
- **Completed:** 2026-02-14T23:14:20Z
- **Tasks:** 2
- **Files modified:** 2

## Accomplishments
- Created four MCP tools following the established query-graph.ts registration pattern
- path_start/path_resolve provide manual override when auto-detection misses or lags
- path_show renders full path details including waypoints and formatted KISS summary dimensions
- path_list displays recent paths in a table with optional status filtering

## Task Commits

Each task was committed atomically:

1. **Task 1: Create debug-paths MCP tool module** - `99806aa` (feat)
2. **Task 2: Wire debug path tools into server startup** - `68375d8` (feat)

## Files Created/Modified
- `src/mcp/tools/debug-paths.ts` - Four MCP tools for debug path lifecycle management with Zod input schemas
- `src/index.ts` - Import and registration call for registerDebugPathTools after PathTracker creation

## Decisions Made
- Response helpers defined locally (not imported from query-graph.ts) since they are trivial 1-liners and avoiding cross-module coupling is cleaner
- path_list uses in-memory status filtering rather than separate SQL queries per status — simpler and the dataset is small (max 50 paths)
- KISS summary parsing uses defensive try/catch so path_show works gracefully even if the JSON format evolves

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered
None

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- All four debug path MCP tools are registered and available to Claude
- path_show formats KISS summaries generated by Plan 01's agent
- Ready for Plan 03 (notification and context tools)

---
*Phase: 20-intelligence-and-mcp-tools*
*Completed: 2026-02-14*
